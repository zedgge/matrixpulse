<!DOCTYPE html>
<html>
<head>
    <title>MatrixPulse Dashboard</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            padding: 20px;
            margin: 0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
        }
        .section {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .regime {
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            padding: 20px;
        }
        .normal { color: #00ff00; }
        .stressed { color: #ffaa00; }
        .crisis { color: #ff0000; text-shadow: 0 0 20px #ff0000; }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: right;
            border: 1px solid #00ff00;
        }
        th {
            background: #003300;
            font-weight: bold;
        }
        .alert {
            padding: 10px;
            margin: 5px 0;
            border-left: 4px solid #ff0000;
            background: #330000;
        }
        .stat {
            display: inline-block;
            margin: 0 20px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš¡ MATRIXPULSE LIVE DASHBOARD âš¡</h1>
        
        <div class="section">
            <div id="regime" class="regime">Loading...</div>
            <div style="text-align: center;">
                <span class="stat">Max Î»: <span id="maxEigen">-</span></span>
                <span class="stat">Condition: <span id="condition">-</span></span>
            </div>
        </div>

        <div class="section">
            <h2>Correlation Matrix</h2>
            <div id="matrix">Loading...</div>
        </div>

        <div class="section">
            <h2>Active Alerts</h2>
            <div id="alerts">No alerts</div>
        </div>
    </div>

    <script>
        const API = 'http://localhost:8081';
        
        async function updateDashboard() {
            try {
                // Get mode
                const modeRes = await fetch(`${API}/mode`);
                const mode = await modeRes.json();
                
                const regimeEl = document.getElementById('regime');
                regimeEl.textContent = `ðŸ”´ ${mode.Regime}`;
                regimeEl.className = `regime ${mode.Regime.toLowerCase()}`;
                
                document.getElementById('maxEigen').textContent = mode.MaxEigen.toFixed(4);
                document.getElementById('condition').textContent = mode.Condition.toFixed(2);
                
                // Get matrix
                const matrixRes = await fetch(`${API}/matrix`);
                const matrix = await matrixRes.json();
                
                let html = '<table><tr><th></th>';
                for (let i = 0; i < Math.min(6, matrix.Symbols.length); i++) {
                    html += `<th>${matrix.Symbols[i]}</th>`;
                }
                html += '</tr>';
                
                for (let i = 0; i < Math.min(6, matrix.Cor.length); i++) {
                    html += `<tr><th>${matrix.Symbols[i]}</th>`;
                    for (let j = 0; j < Math.min(6, matrix.Cor[i].length); j++) {
                        const val = matrix.Cor[i][j];
                        const color = Math.abs(val) > 0.8 ? '#ff6666' : '#00ff00';
                        html += `<td style="color: ${color}">${val.toFixed(3)}</td>`;
                    }
                    html += '</tr>';
                }
                html += '</table>';
                document.getElementById('matrix').innerHTML = html;
                
                // Get alerts
                const alertsRes = await fetch(`${API}/alerts`);
                const alerts = await alertsRes.json();
                
                if (alerts && alerts.length > 0) {
                    html = '';
                    for (let i = Math.max(0, alerts.length - 10); i < alerts.length; i++) {
                        const a = alerts[i];
                        html += `<div class="alert">
                            <strong>[${a.Level}]</strong> ${a.Symbol}: ${a.Message} 
                            (${a.Value.toFixed(4)})
                        </div>`;
                    }
                    document.getElementById('alerts').innerHTML = html;
                } else {
                    document.getElementById('alerts').innerHTML = 'No alerts - market stable';
                }
                
            } catch (err) {
                console.error('Update failed:', err);
            }
        }
        
        // Update every 2 seconds
        updateDashboard();
        setInterval(updateDashboard, 2000);
    </script>
</body>
</html>